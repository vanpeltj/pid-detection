"""
DO NOT EDIT! THIS IS AN AUTOGENERATED FILE!!!!!
"""

from datetime import datetime
from sqlalchemy.types import (
    Integer,
    BigInteger,
    String,
    DateTime,
    Float,
    Boolean,
    PickleType,
    Enum,
)
from sqlalchemy.schema import Column, UniqueConstraint, Index, ForeignKey
from sqlalchemy.sql import text, true, false
from sqlalchemy.sql.functions import func, Function
from sqlalchemy.orm import relationship, Mapped, mapped_column
from sqlalchemy.dialects.postgresql import JSONB, ARRAY

from utils.enums import *
from core.database.base_model import Base


class pid_file(Base):
    __tablename__ = "pid_file"

    id: Mapped[int] = mapped_column(
        Integer, nullable=False, primary_key=True, autoincrement=True
    )
    project_id: Mapped[int] = mapped_column(
        Integer,
        ForeignKey("project.id", ondelete="CASCADE"),
        nullable=False,
        index=True,
    )
    version: Mapped[str] = mapped_column(String, nullable=True)
    file_name: Mapped[str] = mapped_column(String, nullable=True)
    file_uuid: Mapped[str] = mapped_column(String, nullable=True)
    technical_name: Mapped[str] = mapped_column(String, nullable=True)
    s3_key: Mapped[str] = mapped_column(String, nullable=True)
    modified_on: Mapped[datetime] = mapped_column(
        DateTime(timezone=True), server_default=func.now(), onupdate=func.now()
    )
    __table_args__ = (
        UniqueConstraint(
            "file_uuid", name="pid_file_uc", postgresql_nulls_not_distinct=True
        ),
    )


# Probably want to implement a trigger dealing with this at the DB level instead.
# This will update even if values do not change
pid_file._set_onupdate = {
    k: v.onupdate.arg
    for k, v in pid_file.__table__.columns.items()
    if v.onupdate is not None and isinstance(v.onupdate.arg, Function)
}
